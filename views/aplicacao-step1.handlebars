<style>
    label {
        font-weight: bold;
    }
    .text-red {
        color: #FF0000
    }
</style>
<main class="my-4" style="flex: 1 1 0">
    <section class="container">
        <h1>Solicitação de Autorização Eletrônica de Viagem (eTA)</h1>
        <hr>
        {{#each errors}}
            <div class="alert alert-danger">{{text}}</div>
        {{else}}
        {{/each}}
        <h2>Acompanhe o progresso da sua aplicação de visto</h2>
        <div class="progress mt-3 mb-5">
            <div class="progress-bar bg-success" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                <p class="m-0 p-0">1. Representante ou titular?</p>
            </div>
            <div class="progress-bar bg-secondary" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                <p class="m-0 p-0">2. Validação</p>
            </div>
            <div class="progress-bar bg-secondary" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                <p class="m-0 p-0">3. Documentos</p>
            </div>
            <div class="progress-bar bg-secondary" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                <p class="m-0 p-0">4. Pagamento</p>
            </div>
        </div>
        <form action="/aplicacaoStep1" method="POST">
            <label class="mb-2" for="representative">Você é responsável ou representante que apresenta a solicitação de eTA em nome de outra pessoa? <span class="text-red">* (obrigatório)</span></label>
            <select class="form-select w-50 mb-3" name="representative" id="representative" onchange="showFields(this.value)" required>
                <option value="">Selecione</option>
                <option value="0">Não</option>
                <option value="1">Sim</option>
            </select>
            <div class="mb-3" id="dynamicFields"></div>
            <input class="btn btn-success mt-5" type="submit" value="Próximo">
        </form>
    </section>
</main>
<script>
    function showFields(type) {
        let dynamicFields = document.getElementById('dynamicFields');
        dynamicFields.innerHTML = ''

        if (type === '') {
            dynamicFields.innerHTML += '<span class="text-red">Selecione alguma das opções acima</span>'
        } else if (type === '1') {
            dynamicFields.innerHTML += '<h2>Detalhes do responsável ou representante</h2><hr>'
            dynamicFields.innerHTML += `
                <label for="relationship">Eu sou <span class="text-red">* (obrigatório)</span></label>
                <select class="form-select w-50 mb-3" name="relationship" id="relationship" onchange="relationType(this.value)" required>
                    <option value="">Selecione</option>
                    <option value="parent-friend">Parente ou amigo</option>
                    <option value="org-rel">Membro de uma organização não governamental ou religiosa</option>
                    <option value="iccrc">Membro do Conselho Regulatório de Consultores de Imigração (ICCRC)</option>
                    <option value="juridico-territorial">Uma sociedade jurídica provincial ou territorial do Canadá</option>
                    <option value="notarios">A Câmara de Notários do Quebec</option>
                    <option value="agent">Agente de viagens</option>
                </select>
                <label for="payed">Você está sendo pago para representar o requerente e preencher o formulário em seu nome? <span class="text-red">* (obrigatório)</span></label>
                <select class="form-select w-50 mb-3" name="payed" id="payed" required>
                    <option value="">Selecione</option>
                    <option value="0">Não</option>
                    <option value="1">Sim</option>
                </select>
                <div id="relationFields"></div>
            `
        }
    }

    function relationType(type) {
        let relationFields = document.getElementById('relationFields');
        relationFields.innerHTML = ''
        
        if(type === '') {
            relationFields.innerHTML += '<span class="text-red">Selecione alguma das opções acima</span>'
        } else if (type === 'parent-friend') {
            relationFields.innerHTML += `
                <label for="name">Nome: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="name" id="name" required>

                <label for="surname">Sobrenome(s): <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="surname" id="surname" required>

                <label for="address">Endereço: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="address" id="address" required>

                <label for="email">E-mail: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="email" name="email" id="email" required>

                <label for="numTel">Número de telefone: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="numTel" id="numTel" required>
            `
        } else if (type === 'org-rel' || type === 'agent') {
            relationFields.innerHTML += `
                <label for="name">Nome: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="name" id="name" required>

                <label for="surname">Sobrenome(s): <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="surname" id="surname" required>

                <label for="orgname">Nome da empresa: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="orgname" id="orgname" required>

                <label for="address">Endereço: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="address" id="address" required>

                <label for="email">E-mail: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="email" name="email" id="email" required>

                <label for="numTel">Número de telefone: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="numTel" id="numTel" required>
            `
        } else if (type === 'iccrc' || type === 'juridico-territorial') {
            relationFields.innerHTML += `
                <label for="numIDmebro">Número de identificação de membro: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="numIDmebro" id="numIDmebro" required>

                <label for="provOuTer">Província ou território: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="provOuTer" id="provOuTer" required>

                <label for="name">Nome: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="name" id="name" required>

                <label for="surname">Sobrenome(s): <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="surname" id="surname" required>

                <label for="orgname">Nome da empresa: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="orgname" id="orgname" required>

                <label for="address">Endereço: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="address" id="address" required>

                <label for="codpostal">Código postal: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="codpostal" id="codpostal" required>

                <label for="email">E-mail: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="email" name="email" id="email" required>

                <label for="numTel">Número de telefone: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="numTel" id="numTel" required>
            `
        } else if (type === 'notarios') {
            relationFields.innerHTML += `
                <label for="numIDmebro">Número de identificação de membro: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="numIDmebro" id="numIDmebro" required>
                
                <label for="name">Nome: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="name" id="name" required>

                <label for="surname">Sobrenome(s): <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="surname" id="surname" required>

                <label for="orgname">Nome da empresa: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="orgname" id="orgname" required>

                <label for="address">Endereço: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="address" id="address" required>

                <label for="email">E-mail: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="email" name="email" id="email" required>
                
                <label for="numTel">Número de telefone: <span class="text-red">* (obrigatório)</span></label>
                <input class="form-control mb-3" type="text" name="numTel" id="numTel" required>
            `
        }
    }
</script>